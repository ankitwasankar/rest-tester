<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dynamic Request Executor</title>
    <style>
        /* Simple styling to enlarge the icons if desired */
        .status-icon {
            font-size: 1.5em;
        }
    </style>
</head>
<body>
<h1>Requests</h1>

<p th:text="${message}"></p>

<table border="1" cellpadding="5" cellspacing="0">
    <tr>
        <th>Request ID</th>
        <th>Method</th>
        <th>URL</th>
        <th>Status</th>
        <th>Action</th>
    </tr>
    <tr th:each="req : ${requests}">
        <td th:text="${req.id}"></td>
        <td th:text="${req.method}"></td>
        <td th:text="${req.url}"></td>
        <td>
            <!-- If a response exists for this request id, show green check; otherwise red cross -->
            <span class="status-icon"
                  th:if="${responses != null and responses.containsKey(req.id)}">✅</span>
            <span class="status-icon"
                  th:unless="${responses != null and responses.containsKey(req.id)}">❌</span>
        </td>
        <td>
            <form th:action="@{/execute}" method="post">
                <!-- Pass the current request id as target -->
                <input type="hidden" name="targetId" th:value="${req.id}" />
                <button type="submit">Execute up to this</button>
            </form>
        </td>
    </tr>
</table>

<h2>Responses</h2>
<div th:if="${responses != null}">
    <ul>
        <li th:each="entry : ${responses}">
            <strong th:text="${entry.key}"></strong>:
            <pre th:text="${entry.value}"></pre>
        </li>
    </ul>
</div>

</body>
</html>
